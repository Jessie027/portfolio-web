<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Works - JessieWu's Archive</title>
    <link rel="stylesheet" href="style.css">
</head>

<body class="fade-in">
    <div class="cursor-dot" id="cursorDot"></div>
    <div class="cursor-circle" id="cursorCircle"></div>
    <div class="dash-line top-scroll"></div>
    <div class="header-bg" style="opacity: 1;"></div>
    <div class="dash-line header-bottom-static" style="opacity: 1;"></div>
    <div class="dash-line bottom-scroll"></div>
    <div class="square top-left"></div>
    <div class="square bottom-right"></div>

    <div class="intro-container moved static-mode">
        <div class="main-title">JessieWu’s Incomplete Archive</div>
    </div>

    <nav class="nav-menu" id="navMenu" style="opacity: 1;">
        <a href="index.html" class="nav-item transition-link">
            <div class="nav-flipper">
                <div class="nav-face nav-front">Home</div>
                <div class="nav-face nav-back">Home</div>
            </div>
        </a>
        <a href="about.html" class="nav-item transition-link">
            <div class="nav-flipper">
                <div class="nav-face nav-front">About</div>
                <div class="nav-face nav-back">About</div>
            </div>
        </a>
        <a href="works.html" class="nav-item transition-link">
            <div class="nav-flipper">
                <div class="nav-face nav-front">Works</div>
                <div class="nav-face nav-back">Works</div>
            </div>
        </a>
        <a href="#" class="nav-item" id="contactBtn">
            <div class="nav-flipper">
                <div class="nav-face nav-front">Contact</div>
                <div class="nav-face nav-back">Contact</div>
            </div>
        </a>
    </nav>

    <main class="works-main">

        <div class="archive-shelf">

            <div class="archive-file completed" data-id="work1">
                <div class="file-spine">
                    <span class="file-code">NO.001</span>
                    <span class="file-title">Aurora Path</span>
                    <div class="file-status-light"></div>
                </div>
                <div class="file-cover" style="background-image: url('images/work1.png');">
                    <div class="cover-overlay">VIEW FILE</div>
                </div>
            </div>

            <div class="archive-file completed" data-id="work2">
                <div class="file-spine">
                    <span class="file-code">NO.002</span>
                    <span class="file-title">Stability Test v0.1</span>
                    <div class="file-status-light"></div>
                </div>
                <div class="file-cover" style="background-image: url('images/work2.jpg');">
                    <div class="cover-overlay">VIEW FILE</div>
                </div>
            </div>

            <div class="archive-file incomplete">
                <div class="file-spine">
                    <span class="file-code">ERROR</span>
                    <span class="file-title">Mood Tips</span>
                    <div class="file-status-light error"></div>
                </div>
                <div class="file-cover" style="background-image: url('images/error1.png');">
                    <div class="cover-overlay">ACCESS DENIED</div>
                    <div class="lock-icon">🔒</div>
                </div>
            </div>

            <div class="archive-file completed" data-id="work3">
                <div class="file-spine">
                    <span class="file-code">NO.003</span>
                    <span class="file-title">Ilianna</span>
                    <div class="file-status-light"></div>
                </div>
                <div class="file-cover" style="background-image: url('images/work3.png');">
                    <div class="cover-overlay">VIEW FILE</div>
                </div>
            </div>

            <div class="archive-file incomplete">
                <div class="file-spine">
                    <span class="file-code">ERROR</span>
                    <span class="file-title">The 'Transient Shell'</span>
                    <div class="file-status-light error"></div>
                </div>
                <div class="file-cover" style="background-image: url('images/error2.png');">
                    <div class="cover-overlay">FILE MISSING</div>
                    <div class="lock-icon">⚠️</div>
                </div>
            </div>

        </div>

        <div class="shelf-line"></div>
    </main>

    <div class="work-detail-overlay" id="workDetailOverlay">

        <div class="detail-top-bar">
            <div class="file-id-tag">FILE_ID: <span id="d-id">UNKNOWN</span></div>
            <div class="file-status-tag">STATUS: DECLASSIFIED</div>
            <button class="close-detail-btn" id="closeDetailBtn">[ CLOSE_FILE ] ×</button>
        </div>

        <div class="detail-content archive-layout">

            <div class="archive-left-col">
                <div class="evidence-frame">
                    <div class="corner-mark tl"></div>
                    <div class="corner-mark tr"></div>
                    <div class="corner-mark bl"></div>
                    <div class="corner-mark br"></div>
                    <img src="" alt="Project Image" class="detail-img">
                    <div class="img-caption">FIG.01 // VISUAL_DATA</div>
                </div>

                <div class="barcode-box">
                    <div class="barcode"></div>
                    <div class="serial-num">SN-7390-2241-X</div>
                </div>
            </div>

            <div class="archive-right-col">

                <div class="report-header">
                    <h1 class="detail-title">PROJECT TITLE</h1>
                    <div class="meta-grid">
                        <div class="meta-item">
                            <span class="label">DATE:</span>
                            <span class="value detail-year">2024</span>
                        </div>
                        <div class="meta-item">
                            <span class="label">TYPE:</span>
                            <span class="value detail-type">UI DESIGN</span>
                        </div>
                        <div class="meta-item">
                            <span class="label">AUTHOR:</span>
                            <span class="value">JESSIE WU</span>
                        </div>
                    </div>
                </div>

                <div class="pages-container" id="dynamicPagesArea"
                    style="flex: 1; position: relative; overflow-y: auto; min-height: 300px;">
                </div>

                <div class="pagination-bar" id="paginationBar"
                    style="border-top: 1px dashed #333; padding-top: 15px; margin-top: auto; display: flex; justify-content: space-between; align-items: center;">

                    <div class="page-indicator"
                        style="font-family: monospace; font-size: 0.9rem; color: var(--accent-color);">
                        PAGE <span id="currPageNum">01</span> / <span id="totalPageNum">--</span>
                    </div>

                    <div class="page-controls" style="display: flex; gap: 10px;">
                        <button id="prevPageBtn" class="nav-arrow-btn">
                            < PREV</button>
                                <button id="nextPageBtn" class="nav-arrow-btn">NEXT ></button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div class="modal-overlay" id="contactModal">
        <div class="modal-card">
            <button class="close-modal-btn" id="closeModal">×</button>
            <div class="modal-header">CONNECTION REQUEST</div>
            <div class="modal-body">
                <p class="modal-desc">您可以写信给我，期待您的来信。</p>
                <div class="email-box">
                    <span id="emailText">jessiewu327@qq.com</span>
                    <button class="copy-btn" id="copyBtn">COPY</button>
                </div>
            </div>
            <div class="modal-deco-line"></div>
        </div>
    </div>

    <script src="transition.js"></script>
    <script src="cursor.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // === 1. 定义数据：想有几页就写几页，想放什么就放什么 ===
            const worksData = {
                'work1': {
                    id: 'NO.001',
                    year: '2024',
                    type: 'Cross-Media Design',
                    title: 'Aurora Path',
                    img: 'images/cover.png',

                    // 核心：这里定义页面列表
                    contentPages: [
                        // 第1页：纯文字简介 (保留了你原来的文字)
                        {
                            type: 'text',
                            title: 'DESCRIPTION //',
                            content: '该项目通过互动装置科普了极光的成因与变化，将科技与叙事相融，带领观众走入故事中，随着小耳廓狐哈桑共同游览并创造独一无二的极光。<br><br>项目使用TouchDesigner模拟极光，YOLOv8模型实现极光跟随。互动装置通过Esp32与传感器实时监测并传输数据，模拟大气成分与太阳风的变化，改变极光形态，增强互动体验，带来沉浸式的科学探索。'
                        },
                        // 第2页：数据与外链 (保留了你的视频链接)
                        {
                            type: 'meta',
                            title: 'SYSTEM_DATA //',
                            tools: ['TouchDesigner', 'YOLOv8', 'Esp32'],
                            keywords: ['IMMERSIVE', 'INTERACTIVE', 'NATURE'],
                            links: [
                                { text: 'WATCH_VIDEO.mp4', url: 'https://www.bilibili.com/video/BV1a4FxenEa5/', icon: '▶' }
                            ]
                        },
                        // 第3页：过程图 (这里是占位符，你可以把图片路径换成你自己的)
                        {
                            type: 'gallery',
                            title: 'ANALYSIS_LOG //',
                            images: ['images/1.1.png']
                        }
                    ]
                },

                'work2': {
                    id: 'NO.002',
                    year: '2024',
                    type: 'Video Game',
                    title: 'Stability Test v0.1',
                    img: 'images/work2.jpg',

                    // Work2 只有2页
                    contentPages: [
                        {
                            type: 'text',
                            title: 'DESCRIPTION //',
                            content: '这是一场关于规则与荒诞的沉浸式实验。<br><br>玩家被选中参与某系统的「稳定性评估」，每日重复着相同的路径：从家到十字路口，再到办公室。一切看似秩序井然——直到玩家开始触碰那些不该触碰的规则。餐桌变成单杠，红绿灯化作食品安全指示牌，同事的工位坍缩成棺材... <br><br>世界正褪去黑白滤镜，裸露出荒诞的彩色内核。'
                        },
                        {
                            type: 'meta',
                            title: 'SYSTEM_DATA //',
                            tools: ['Unity', 'C#', 'Procreate'],
                            keywords: ['DYSTOPIA', 'GAME_DEV', 'NARRATIVE']
                            // 这个作品没有外链，所以不写 links
                        },
                        {
                            type: 'text',
                            title: 'WORLDVIEW_SETTING //',
                            content: '玩家是一名过着规律生活的普通打工人，每日往返于家与办公室之间。他所看到的世界始终是黑白的，所有物体都被简化为外轮廓。虽然感到异样，但因生活尚能维持，便逐渐习以为常。<br><br>主角的生活中伴随着一段神秘旁白，时而调侃，时而指引，并制定了各种“规则”。直到某天，玩家无意打破其中一条，世界开始失控，旁白变得慌乱，现实出现裂缝。<br><br>原来这是一场由高维生命体搭建的“系统稳定性测试”，玩家是被随机选中的“测试员”。为了节省精力，这些存在以相似物体冒充真实物品，并用黑白滤镜遮蔽细节，再用规则限制玩家的认知。但讽刺的是，这些规则反而成为主角觉醒与抗争的开端。'
                        },
                        {
                            type: 'text_image',
                            title: 'VISUAL_LANGUAGE //',
                            img: 'images/2.1.png',
                            imgRef: '游戏内部分物品变化前后展示',
                            content: '游戏采用 2.5D 形式营造空间感。初始阶段，世界呈现为纯粹的黑白线条风格，所有物体仅以轮廓存在，象征被简化与遮蔽的认知状态。<br><br>当玩家打破规则后，部分物体转化为彩色实体，揭示其真实面貌。黑白与彩色之间的反差，不只是视觉对比，更象征认知突破与系统漏洞的显现。每一次色彩渗入，都是一次秩序的崩塌。'
                        }
                    ]
                },

                // Work3 只有1页
                'work3': {
                    id: 'NO.003',
                    year: '2024',
                    type: 'Character Design',
                    title: 'Ilianna',
                    img: 'images/work3.png',
                    contentPages: [
                        {
                            type: 'text',
                            title: 'DESCRIPTION //',
                            content: '故事背景：<br>二级学院被里世界怪物“它”侵入，无辜师生和一些学校领地会被“它”拉入里世界，人类阵营为保护无辜师生、抵抗“它”的污染并战胜“它”，任命了班委、辅导员、校工部、督查部、保安部等组织，并分别为其设立了一系列规则以抵抗“它”的认知污染。<br><br>人物经历：<br>伊莉安那本来只是一个普通学生，但因为某些原因被“它”看中选为自己的眷属，从此会受“它”影响无意识地在表里世界穿梭。由于从里世界逃出来的学生都会强制加入督查部，所以伊莉安那在第一次被“它”从里世界送出来后成为了督查部的一员。<br><br>人物设定：<br>本性是一个有点胆小的善良的普通学生，非常喜欢自己的学校和同学们，虽然在入校后隐约察觉到了一些怪异的地方，但还是在普通地过着自己的校园生活。被“它”选中后拥有了表里二重人格，表人格就是原本的人格；里人格是被“它”污染时的人格，会帮助“它”将身边的师生不加伤害地引入到里世界中。里人格主导时会拥有表人格的记忆，但表人格主导时不会拥有里人格的记忆。'
                        },
                        // 在 worksData 的 contentPages 数组里添加：
                        {
                            type: 'text_image',
                            title: 'ANALYSIS_LOG //',  // 页面标题
                            img: 'images/3.1.png', // 图片路径
                            imgRef: '三视图',          // [可选] 图片右下角的编号，不填默认显示 IMG_DATA
                            content: ''
                        },
                        {
                            type: 'text_image',
                            title: 'ANALYSIS_LOG //',  // 页面标题
                            img: 'images/3.2.png', // 图片路径
                            imgRef: '表情差分',          // [可选] 图片右下角的编号，不填默认显示 IMG_DATA
                            content: ''
                        },
                        {
                            type: 'text_image',
                            title: 'ANALYSIS_LOG //',  // 页面标题
                            img: 'images/3.3.png', // 图片路径
                            imgRef: '重要道具',          // [可选] 图片右下角的编号，不填默认显示 IMG_DATA
                            content: ''
                        },
                    ]
                }
            };

            // === 2. 核心逻辑：自动生成页面 ===
            let currentPageIndex = 0; // 从0开始计数
            let currentProjectPages = []; // 当前项目的页面数据

            // 渲染单个页面内容的辅助函数
            function renderPageHTML(pageData, index) {
                let innerHTML = '';

                // 根据 type 生成不同类型的 HTML
                if (pageData.type === 'text') {
                    // [类型：纯文字]
                    innerHTML = `<div class="detail-body"><p>${pageData.content}</p></div>`;

                } else if (pageData.type === 'meta') {
                    // [类型：数据+链接]
                    let toolsHTML = pageData.tools ? pageData.tools.map(t => `<span class="tech-tag">${t}</span>`).join('') : '';
                    let kwHTML = pageData.keywords ? pageData.keywords.map(k => `<span class="keyword-tag">#${k}</span>`).join('') : '';
                    let linksHTML = pageData.links ? pageData.links.map(l => `
                        <a href="${l.url}" target="_blank" class="archive-btn">
                            <span class="icon">${l.icon}</span> ${l.text}
                        </a>`).join('') : '';

                    innerHTML = `
                        <div class="tech-stack-section" style="margin-bottom:1.5rem">
                            <div class="sub-label" style="font-size:0.7rem;color:#666;margin-bottom:0.5rem">> TOOLS</div>
                            <div class="tech-tags-container">${toolsHTML}</div>
                        </div>
                        <div class="concept-section" style="margin-bottom:2rem">
                            <div class="sub-label" style="font-size:0.7rem;color:#666;margin-bottom:0.5rem">> KEYWORDS</div>
                            <div class="concept-tags-container">${kwHTML}</div>
                        </div>
                        <div class="project-links" style="display:flex;gap:1rem;flex-wrap:wrap">${linksHTML}</div>
                    `;

                } else if (pageData.type === 'text_image') {

                    // 1. 生成图片 HTML (带一个小的装饰性编号)
                    const imgHTML = `
                    <div class="archive-inset-box" style="margin-top: 1.5rem;">
                    <img src="${pageData.img}" class="archive-inset-img">
                    <div class="inset-caption">REF: ${pageData.imgRef || 'IMG_DATA'}</div>
                    </div>
                    `;

                    // 2. 生成文字 HTML
                    const textHTML = `<div class="detail-body"><p>${pageData.content}</p></div>`;

                    // 3. 组合 (你可以交换这两个变量的顺序来决定图片在文字上面还是下面)
                    innerHTML = textHTML + imgHTML;

                    // ⬆️⬆️⬆️ [新增结束] ⬆️⬆️⬆️

                } else if (pageData.type === 'gallery') {
                    // [类型：图片墙]
                    let imgsHTML = pageData.images.map(src => `<img src="${src}" class="process-thumb">`).join('');
                    innerHTML = `<div class="process-grid" style="display:grid;grid-template-columns:1fr;gap:20px">${imgsHTML}</div>`;
                }

                // 返回完整的页面 DOM 结构
                return `
                    <div class="archive-page" id="page-${index}" style="display: none;">
                        <div class="body-label">${pageData.title}</div>
                        ${innerHTML}
                    </div>
                `;
            }

            // 刷新翻页器状态
            function updatePaginationUI() {
                const total = currentProjectPages.length;

                // 1. 显示/隐藏页面
                for (let i = 0; i < total; i++) {
                    const pageEl = document.getElementById(`page-${i}`);
                    if (pageEl) {
                        // 如果是当前页
                        if (i === currentPageIndex) {
                            pageEl.style.display = 'block';

                            // --- 核心技巧：移除 -> 强制重绘 -> 添加 ---
                            pageEl.classList.remove('active');

                            // 这行代码虽然看起来没用，但它强制浏览器重新计算布局，从而重置动画
                            void pageEl.offsetWidth;

                            pageEl.classList.add('active');

                        } else {
                            // 如果不是当前页，直接隐藏
                            pageEl.style.display = 'none';
                            pageEl.classList.remove('active');
                        }
                    }
                }

                // 2. 更新页码文字
                document.getElementById('currPageNum').innerText = `0${currentPageIndex + 1}`;
                document.getElementById('totalPageNum').innerText = `0${total}`;

                // 3. 更新按钮状态
                const prevBtn = document.getElementById('prevPageBtn');
                const nextBtn = document.getElementById('nextPageBtn');
                const navBar = document.getElementById('paginationBar');

                // 如果只有1页，隐藏整个翻页条，或者禁用按钮
                if (total <= 1) {
                    navBar.style.opacity = '0.3'; // 变淡
                    navBar.style.pointerEvents = 'none'; // 甚至不可点击
                } else {
                    navBar.style.opacity = '1';
                    navBar.style.pointerEvents = 'auto';

                    prevBtn.classList.toggle('disabled', currentPageIndex === 0);
                    nextBtn.classList.toggle('disabled', currentPageIndex === total - 1);
                }
            }

            // === Works 页面专属逻辑 ===
            const allFiles = document.querySelectorAll('.archive-file');
            const overlay = document.getElementById('workDetailOverlay');
            const closeDetailBtn = document.getElementById('closeDetailBtn');
            const container = document.getElementById('dynamicPagesArea');

            // 检查 URL 是否要求自动打开某个作品
            const urlParams = new URLSearchParams(window.location.search);
            const targetId = urlParams.get('open'); // 获取 ?open= 后面的值

            if (targetId) {
                const targetFile = document.querySelector(`.archive-file[data-id="${targetId}"]`);
                if (targetFile) {
                    setTimeout(() => {
                        targetFile.click();
                    }, 600);
                }
            }

            // 点击事件中的注入逻辑更新
            allFiles.forEach(file => {
                file.addEventListener('click', () => {
                    if (file.classList.contains('incomplete')) return;

                    const id = file.getAttribute('data-id');
                    const data = worksData[id];

                    if (data) {
                        // 1. 填充头部基本信息 (标题、年份等)
                        overlay.querySelector('#d-id').innerText = data.id;
                        overlay.querySelector('.detail-img').src = data.img;
                        overlay.querySelector('.detail-title').innerText = data.title;
                        overlay.querySelector('.detail-year').innerText = data.year;
                        overlay.querySelector('.detail-type').innerText = data.type;

                        // 2. [核心] 生成动态页面
                        currentProjectPages = data.contentPages || []; // 获取页面数组
                        currentPageIndex = 0; // 重置为第1页
                        container.innerHTML = ''; // 清空容器

                        // 循环生成每一页的 HTML
                        currentProjectPages.forEach((pageData, index) => {
                            container.innerHTML += renderPageHTML(pageData, index);
                        });

                        // 3. 初始化分页 UI
                        updatePaginationUI();

                        overlay.classList.add('active');
                    }
                });
            });

            // 关闭详情页
            closeDetailBtn.addEventListener('click', () => {
                overlay.classList.remove('active');
            });

            // === 翻页按钮事件 ===
            document.getElementById('prevPageBtn').addEventListener('click', () => {
                if (currentPageIndex > 0) {
                    currentPageIndex--;
                    updatePaginationUI();
                }
            });

            document.getElementById('nextPageBtn').addEventListener('click', () => {
                if (currentPageIndex < currentProjectPages.length - 1) {
                    currentPageIndex++;
                    updatePaginationUI();
                }
            });

            // --- Contact 弹窗逻辑 (通用) ---
            const contactBtn = document.getElementById('contactBtn');
            const contactModal = document.getElementById('contactModal');
            const closeModalBtn = document.getElementById('closeModal');
            const copyBtn = document.getElementById('copyBtn');
            const emailText = document.getElementById('emailText');

            if (contactBtn) {
                contactBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    contactModal.classList.add('active');
                });
            }
            if (closeModalBtn) {
                closeModalBtn.addEventListener('click', () => {
                    contactModal.classList.remove('active');
                });
            }
            if (contactModal) {
                contactModal.addEventListener('click', (e) => {
                    if (e.target === contactModal) contactModal.classList.remove('active');
                });
            }
            if (copyBtn) {
                copyBtn.addEventListener('click', () => {
                    const email = emailText.innerText;
                    navigator.clipboard.writeText(email).then(() => {
                        const originalText = copyBtn.innerText;
                        copyBtn.innerText = "COPIED!";
                        copyBtn.style.borderColor = "var(--accent-color)";
                        copyBtn.style.color = "var(--accent-color)";
                        setTimeout(() => {
                            copyBtn.innerText = originalText;
                            copyBtn.style.borderColor = "";
                            copyBtn.style.color = "";
                        }, 2000);
                    });
                });
            }
        });
    </script>
</body>

</html>