<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JessieWu's Archive</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div id="preloader">
        <div class="loader-content-geometry">
            <div class="loader-box-wrapper">
                <div class="outer-dashed-box"></div>
                <div class="inner-solid-box" id="innerBox">
                    <span id="loaderPercent">0%</span>
                </div>
            </div>

            <div class="loader-text-group">
                <div class="loader-title">ARCHIVE_SYSTEM_V1.0</div>
                <div class="loader-status">COMPILING DATA...</div>
            </div>
        </div>
    </div>
    <div class="dash-line top-scroll"></div>
    <div class="header-bg" id="headerBg"></div>
    <div class="dash-line header-bottom-static" id="staticLine"></div>
    <div class="dash-line bottom-scroll"></div>
    <div class="square top-left"></div>
    <div class="square bottom-right"></div>

    <div class="intro-container" id="introBox">
        <div class="main-title">JessieWu’s Incomplete Archive</div>
        <div class="subtitle">—— 记录一些作品 以及 未完成的故事 ——</div>
    </div>

    <nav class="nav-menu" id="navMenu">
        <a href="index.html" class="nav-item transition-link">
            <div class="nav-flipper">
                <div class="nav-face nav-front">Home</div>
                <div class="nav-face nav-back">Home</div>
            </div>
        </a>
        <a href="about.html" class="nav-item transition-link">
            <div class="nav-flipper">
                <div class="nav-face nav-front">About</div>
                <div class="nav-face nav-back">About</div>
            </div>
        </a>
        <a href="works.html" class="nav-item transition-link">
            <div class="nav-flipper">
                <div class="nav-face nav-front">Works</div>
                <div class="nav-face nav-back">Works</div>
            </div>
        </a>
        <a href="#" class="nav-item" id="contactBtn">
            <div class="nav-flipper">
                <div class="nav-face nav-front">Contact</div>
                <div class="nav-face nav-back">Contact</div>
            </div>
        </a>
    </nav>

    <main class="main-content manual-trigger" id="mainContent">
        <div class="center-stage-wrapper">
            <div class="corner-decor top-left"></div>
            <div class="img-layer"></div>
            <div class="guide-lines-box">
                <div class="corner-decor bottom-right"></div>
            </div>
            <div class="caption-text">点击查看精选代表作</div>
        </div>
        <div class="scroll-column left">
            <div class="tag-track scroll-down">
                <a href="about.html" class="tag-box transition-link">STORYTELLER</a>
                <a href="about.html" class="tag-box transition-link">INFJ</a>
                <a href="about.html" class="tag-box transition-link">VISUAL THINKER</a>
                <a href="about.html" class="tag-box transition-link">DESIGNER</a>
                <a href="about.html" class="tag-box transition-link">EXPERIMENTAL</a>
                <a href="about.html" class="tag-box transition-link">STORYTELLER</a>
                <a href="about.html" class="tag-box transition-link">INFJ</a>
                <a href="about.html" class="tag-box transition-link">VISUAL THINKER</a>
                <a href="about.html" class="tag-box transition-link">DESIGNER</a>
                <a href="about.html" class="tag-box transition-link">EXPERIMENTAL</a>
            </div>
        </div>
        <div class="scroll-column right">
            <div class="tag-track scroll-up">
                <a href="about.html" class="tag-box transition-link">FIGMA</a>
                <a href="about.html" class="tag-box transition-link">BLENDER</a>
                <a href="about.html" class="tag-box transition-link">TOUCHDESIGNER</a>
                <a href="about.html" class="tag-box transition-link">PYTHON</a>
                <a href="about.html" class="tag-box transition-link">UNITY</a>
                <a href="about.html" class="tag-box transition-link">FIGMA</a>
                <a href="about.html" class="tag-box transition-link">BLENDER</a>
                <a href="about.html" class="tag-box transition-link">TOUCHDESIGNER</a>
                <a href="about.html" class="tag-box transition-link">PYTHON</a>
                <a href="about.html" class="tag-box transition-link">UNITY</a>
            </div>
        </div>
    </main>

    <div class="modal-overlay" id="contactModal">
        <div class="modal-card">
            <button class="close-modal-btn" id="closeModal">×</button>
            <div class="modal-header">CONNECTION REQUEST</div>
            <div class="modal-body">
                <p class="modal-desc">您可以写信给我，期待您的来信。</p>
                <div class="email-box">
                    <span id="emailText">jessiewu327@qq.com</span>
                    <button class="copy-btn" id="copyBtn">COPY</button>
                </div>
            </div>
            <div class="modal-deco-line"></div>
        </div>
    </div>

    <div class="cursor-dot" id="cursorDot"></div>
    <div class="cursor-circle" id="cursorCircle"></div>

    <script src="transition.js"></script>
    <script src="cursor.js"></script>

    <script>
        /* --- index.html 底部 script 完全替换 --- */

        document.addEventListener('DOMContentLoaded', () => {

            const preloader = document.getElementById('preloader');

            // 1. 定义开场动画流程 (这是你要保留的动效)
            function playHomeIntro() {
                const introBox = document.getElementById('introBox');
                const mainTitle = introBox.querySelector('.main-title');
                const subtitle = introBox.querySelector('.subtitle');
                const navMenu = document.getElementById('navMenu');
                const mainContent = document.getElementById('mainContent');
                const headerBg = document.getElementById('headerBg');
                const staticLine = document.getElementById('staticLine');

                // A. 初始状态重置 (防止二次进入时状态不对)
                // 确保标题是大且透明的，副标题也是透明的
                mainTitle.style.opacity = "0";
                subtitle.style.opacity = "0";
                introBox.classList.remove('moved');

                // B. 开始播放动画序列

                // 0.5秒后：大标题淡入
                setTimeout(() => { mainTitle.style.opacity = "1"; }, 500);

                // 1.5秒后：副标题淡入
                setTimeout(() => { subtitle.style.opacity = "1"; }, 1500);

                // 3.0秒后：Header 形成 (标题变小移位、副标题消失、导航栏出现)
                setTimeout(() => {
                    introBox.classList.add('moved');
                    headerBg.style.opacity = "1";
                    staticLine.style.opacity = "1";
                    navMenu.style.opacity = "1";
                }, 3000);

                // 4.0秒后：内容淡入
                setTimeout(() => { mainContent.classList.add('fade-in'); }, 4000);
            }

            // 2. 检查是否第一次访问
            const hasVisited = sessionStorage.getItem('hasVisited');

            if (!hasVisited) {
                // === 情况 A: 第一次访问 (跑 Loading) ===
                sessionStorage.setItem('hasVisited', 'true');

                // Loading 动画逻辑
                const innerBox = document.getElementById('innerBox');
                const loaderPercent = document.getElementById('loaderPercent');
                let progress = 0;

                const timer = setInterval(() => {
                    progress += Math.random() * 2;
                    if (progress > 100) progress = 100;
                    const scaleValue = progress / 100;
                    if (innerBox) innerBox.style.transform = `translate(-50%, -50%) scale(${scaleValue})`;
                    if (loaderPercent) loaderPercent.innerText = Math.floor(progress) + '%';

                    if (progress === 100) {
                        clearInterval(timer);
                        setTimeout(() => {
                            // 淡出 Loading
                            preloader.style.opacity = '0';
                            preloader.style.pointerEvents = 'none';
                            // 播放开场动画
                            playHomeIntro();
                        }, 800);
                    }
                }, 30);

            } else {
                // === 情况 B: 回头客 (跳过 Loading，但保留开场动画) ===
                preloader.style.display = 'none'; // 瞬间关掉 Loading

                // 直接播放开场动画
                playHomeIntro();
            }


            // --- 其他逻辑 (保持不变) ---
            const centerStage = document.querySelector('.center-stage-wrapper');
            const mainContent = document.getElementById('mainContent');
            if (centerStage) {
                centerStage.style.cursor = 'pointer';
                centerStage.addEventListener('click', () => {
                    if (mainContent) mainContent.classList.remove('fade-in');
                    setTimeout(() => { window.location.href = 'works.html?open=work1'; }, 400);
                });
            }

            const contactBtn = document.getElementById('contactBtn');
            const contactModal = document.getElementById('contactModal');
            const closeModalBtn = document.getElementById('closeModal');
            const copyBtn = document.getElementById('copyBtn');
            const emailText = document.getElementById('emailText');
            if (contactBtn) { contactBtn.addEventListener('click', (e) => { e.preventDefault(); contactModal.classList.add('active'); }); }
            if (closeModalBtn) { closeModalBtn.addEventListener('click', () => { contactModal.classList.remove('active'); }); }
            if (contactModal) { contactModal.addEventListener('click', (e) => { if (e.target === contactModal) contactModal.classList.remove('active'); }); }
            if (copyBtn) {
                copyBtn.addEventListener('click', () => {
                    const email = emailText.innerText;
                    navigator.clipboard.writeText(email).then(() => {
                        const originalText = copyBtn.innerText;
                        copyBtn.innerText = "COPIED!";
                        copyBtn.style.borderColor = "var(--accent-color)";
                        copyBtn.style.color = "var(--accent-color)";
                        setTimeout(() => {
                            copyBtn.innerText = originalText;
                            copyBtn.style.borderColor = "";
                            copyBtn.style.color = "";
                        }, 2000);
                    });
                });
            }
        });
    </script>
</body>

</html>